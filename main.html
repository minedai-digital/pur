<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø­Ø³Ù‘Ù†Ø©</title>
    <meta name="description" content="Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª ÙˆØ§Ù„ØªÙˆØ±ÙŠØ¯Ø§Øª - Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ">
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@700&family=Lateef&family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #2196f3;
            --primary-dark: #1865be;
            --success-color: #1ebea5;
            --danger-color: #dc3545;
            --warning-color: #ffc107;
            --info-color: #156ab2;
            --border-color: #bedff1;
            --text-dark: #0e375c;
            --text-light: #174053;
            --radius-sm: 7px;
            --radius-md: 11px;
            --radius-lg: 18px;
            --shadow-md: 0 3px 14px rgba(176, 230, 239, 0.2);
            --gradient-primary: linear-gradient(135deg, #2196f3 0%, #1865be 100%);
            --gradient-success: linear-gradient(90deg, #1ebea5 0%, #156ab2 100%);
            --gradient-hover: linear-gradient(90deg, #2196f3 10%, #43d5a0 85%);
        }

        *, *::before, *::after {
            box-sizing: border-box;
        }

        body {
            font-family: 'Cairo', 'Lateef', sans-serif;
            background-color: #f8fafb;
            margin: 0;
            direction: rtl;
            min-height: 100vh;
            line-height: 1.6;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }

        /* Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ */
        .navbar {
            position: sticky;
            top: 0;
            z-index: 100;
            background-color: var(--info-color);
            color: white;
            padding: 10px 15px;
            border-radius: 0 0 var(--radius-lg) var(--radius-lg);
            box-shadow: var(--shadow-md);
            transition: box-shadow 0.3s ease;
        }

        .nav-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 15px;
        }

        .nav-logo {
            font-size: 1.21rem;
            font-family: 'Amiri', serif;
            letter-spacing: 0.5px;
        }

        .nav-links {
            display: flex;
            gap: 7px;
            margin: 0;
            padding: 0;
            list-style: none;
            flex-wrap: wrap;
            justify-content: center;
        }

        .nav-links a {
            color: white;
            text-decoration: none;
            padding: 9px 16px;
            border-radius: var(--radius-sm);
            transition: background 0.2s ease;
            font-family: 'Cairo', sans-serif;
            font-weight: 600;
        }

        .nav-links a:hover,
        .nav-links a.active {
            background: var(--gradient-hover);
            color: #fffd9b;
        }

        .btn-login {
            background-color: #fcfbc3;
            padding: 9px 18px;
            border: none;
            border-radius: var(--radius-sm);
            font-size: 1rem;
            color: #3269b7;
            cursor: pointer;
            font-family: 'Cairo';
            font-weight: bold;
            transition: background 0.13s ease;
        }

        .btn-login:hover {
            background: #fdf9ac;
        }

        /* Ø§Ù„ØªØ±ÙˆÙŠØ³Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
        .main-header {
            background: var(--gradient-primary);
            color: white;
            padding: 1.6rem 1rem;
            text-align: center;
            box-shadow: var(--shadow-md);
            margin-bottom: 2rem;
            border-radius: 0 0 25px 25px;
        }

        .main-header h1 {
            font-family: 'Amiri', serif;
            font-size: 2.2rem;
            margin: 0;
            letter-spacing: 0.7px;
        }

        .entity-bar {
            font-size: 1.13rem;
            background-color: #e3f7f9;
            color: #215e87;
            margin: 10px auto 0;
            padding: 7px 12px;
            display: inline-block;
            border-radius: var(--radius-sm);
            min-width: 110px;
        }

        /* Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª */
        .stats-summary {
            display: flex;
            justify-content: center;
            gap: 2.2rem;
            flex-wrap: wrap;
            align-items: center;
            margin: 1.1rem 0 1.4rem;
        }

        .stats-summary > div {
            font-size: 1.08rem;
            font-weight: 700;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(210px, 1fr));
            gap: 1.1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background-color: white;
            padding: 1.25rem 0.75rem;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-md);
            text-align: center;
            transition: box-shadow 0.2s ease, transform 0.2s ease;
        }

        .stat-card:hover {
            box-shadow: 0 5px 20px rgba(176, 230, 239, 0.3);
            transform: translateY(-2px);
        }

        .stat-card h3 {
            color: #2380bf;
            font-size: 1.04rem;
            margin-bottom: 0.3rem;
        }

        .stat-card .stat-value {
            font-size: 1.49rem;
            font-weight: bold;
            color: #166c81;
        }

        /* Ø§Ù„Ø£Ù‚Ø³Ø§Ù… */
        .form-section,
        .signatures-section,
        .controls-section,
        .entity-config-section {
            background-color: white;
            padding: 2rem 1.1rem;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-md);
            margin-bottom: 2rem;
        }

        .section-title {
            font-family: 'Amiri', serif;
            font-size: 1.22rem;
            color: #1769ae;
            margin: 0 0 1.1rem 0;
            display: flex;
            align-items: center;
        }

        .section-title span {
            margin-left: 7px;
        }

        /* Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ */
        .input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(230px, 1fr));
            gap: 1.22rem;
        }

        .enhanced-input label {
            color: #165b62;
            font-weight: 700;
            display: block;
            margin-bottom: 0.3rem;
        }

        .enhanced-input input {
            width: 100%;
            padding: 0.63rem 1rem;
            border: 2px solid var(--border-color);
            border-radius: var(--radius-md);
            font-size: 1rem;
            color: var(--text-dark);
            background: #fbfdff;
            transition: border 0.18s ease, background 0.18s ease;
        }

        .enhanced-input input:focus {
            border-color: #40b0fa;
            background: #f2fcff;
            outline: none;
        }

        .enhanced-input input[type="date"] {
            direction: ltr;
            text-align: right;
        }

        .enhanced-input input[readonly] {
            background: #f4f5fb;
            color: #7c7e8b;
            cursor: not-allowed;
        }

        /* Ø¥Ø®ÙØ§Ø¡ Ø£Ø³Ù‡Ù… input number */
        input[type="number"]::-webkit-outer-spin-button,
        input[type="number"]::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        input[type="number"] {
            appearance: textfield;
            -moz-appearance: textfield;
        }

        /* Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ */
        .table-container {
            background: #fff;
            border-radius: var(--radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow-md);
            margin-bottom: 1.6rem;
        }

        .table-header {
            background: var(--primary-color);
            color: white;
            padding: 1rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        .table-wrapper {
            width: 100%;
            overflow-x: auto;
        }

        .enhanced-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 1200px;
            margin-bottom: 0;
        }

        .enhanced-table th {
            background: var(--primary-dark);
            color: white;
            padding: 0.92rem 0.5rem;
            text-align: center;
            font-size: 1.02rem;
            font-weight: 700;
        }

        .enhanced-table td {
            padding: 0.7rem;
            border: 1px solid var(--border-color);
            text-align: center;
            white-space: nowrap;
        }

        .enhanced-table input {
            font-weight: 600;
            background-color: #f8fdff;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            padding: 5px 7px;
            font-size: 1rem;
            width: 100%;
            min-width: 80px;
            transition: border-color 0.15s ease;
        }

        .enhanced-table input:focus {
            border-color: var(--primary-color);
            outline: none;
        }

        .enhanced-table input[readonly] {
            background: #f7fafb;
            color: #666;
            border: 1px solid #eee;
            font-weight: bold;
        }

        .enhanced-table tfoot td {
            font-weight: bold;
            background: #e3f2fd;
        }

        .enhanced-table tfoot tr:last-child {
            font-size: 1.08rem;
            font-weight: bold;
        }

        .highlight-cell {
            background: #9afdcd !important;
            color: #084e27 !important;
        }

        /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
        .action-buttons {
            display: flex;
            gap: 0.6rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn {
            background: var(--gradient-success);
            color: white;
            border: none;
            border-radius: var(--radius-md);
            padding: 0.58rem 1.3rem;
            font-size: 1rem;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 0.45rem;
            transition: box-shadow 0.18s ease, background 0.14s ease, transform 0.1s ease;
            font-family: "Cairo", 'Lateef', sans-serif;
        }

        .btn:hover {
            box-shadow: 0 2px 6px rgba(58, 172, 175, 0.2);
            background: var(--gradient-hover);
            transform: translateY(-1px);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn:focus {
            outline: 2px solid #168ac1;
            outline-offset: 2px;
        }

        .btn-delete {
            background: var(--danger-color) !important;
        }

        .btn-delete:hover {
            background: #c82333 !important;
        }

        /* Ø§Ù„ØªÙˆÙ‚ÙŠØ¹Ø§Øª */
        .signatures-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(205px, 1fr));
            gap: 1.3rem;
        }

        .signature-card {
            background: #f5f9fc;
            padding: 1.1rem;
            border-radius: var(--radius-md);
            border: 1px solid #d2eaf1;
            font-family: 'Lateef', serif;
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø§Ù„ÙˆØµÙˆÙ„ */
        [tabindex]:not([tabindex="-1"]) {
            outline: none;
        }

        [tabindex]:not([tabindex="-1"]):focus {
            outline: 2px solid var(--primary-color);
            outline-offset: 2px;
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            border: 0;
        }

        /* Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
        @media (max-width: 950px) {
            .enhanced-table {
                min-width: 1000px;
            }
        }

        @media (max-width: 800px) {
            .table-wrapper::before {
                content: "âŸ· Ø§Ø³Ø­Ø¨ Ù„Ø±Ø¤ÙŠØ© Ø§Ù„Ø¬Ø¯ÙˆÙ„";
                display: block;
                text-align: center;
                padding: 8px;
                background: #e3f2fd;
                color: #1976d2;
                margin-bottom: 10px;
                border-radius: var(--radius-sm);
            }

            .form-section,
            .signatures-section,
            .controls-section,
            .entity-config-section {
                padding: 1rem 0.5rem;
            }

            .stats-summary {
                gap: 10px;
            }
        }

        @media (max-width: 460px) {
            .main-header h1 {
                font-size: 1.5rem;
            }

            .entity-bar {
                font-size: 1rem;
            }
        }

        /* Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ£ÙƒÙŠØ¯ */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--success-color);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: var(--radius-md);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Ù„Ù„Ø·Ø¨Ø§Ø¹Ø© */
        @media print {
            .navbar,
            .controls-section,
            .btn {
                display: none !important;
            }

            body {
                background: white;
            }

            .container {
                max-width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- Ù†Ø§ÙØ¨Ø§Ø± -->
    <nav class="navbar" aria-label="Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ">
        <div class="container nav-container">
            <div class="nav-logo" title="Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©"><span>ğŸ¥</span> Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</div>
            <ul class="nav-links" aria-label="Ø±ÙˆØ§Ø¨Ø· Ø§Ù„ØªÙ†Ù‚Ù„">
                <li><a href="main.html" class="active" tabindex="0">ğŸ“‹ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ</a></li>
                <li><a href="taw.html" tabindex="0">ğŸ“¦ Ø£Ù…Ø± Ø§Ù„ØªÙˆØ±ÙŠØ¯</a></li>
                <li><a href="taf.html" tabindex="0">ğŸ’° ØªÙØ±ÙŠØº Ø§Ù„Ø£Ø³Ø¹Ø§Ø±</a></li>
                <li><a href="mahdr.html" tabindex="0">ğŸ“ Ø§Ù„Ù…Ø­Ø¶Ø±</a></li>
                <li><a href="talab.html" tabindex="0">ğŸ“„ Ø·Ù„Ø¨ Ø§Ù„Ø´Ø±Ø§Ø¡</a></li>
                <li><a href="moka.html" tabindex="0">ğŸ“ˆ Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø©</a></li>
                <li><a href="tash.html" tabindex="0">ğŸ‘¥ ØªØ´ÙƒÙŠÙ„ Ù„Ø¬Ù†Ø©</a></li>
                <li><a href="custom.html" tabindex="0">ğŸ“Š Ø§Ù„Ø¶Ø±Ø§Ø¦Ø¨</a></li>
            </ul>
            <div class="nav-login">
                <button class="btn-login" onclick="handleLogout()" title="ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬" tabindex="0"><span>ğŸšª</span> ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
            </div>
        </div>
    </nav>

    <!-- Ø±Ø£Ø³ Ø§Ù„ØµÙØ­Ø© -->
    <header class="main-header">
        <h1 id="entityNameHeader">Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª ÙˆØ§Ù„ØªÙˆØ±ÙŠØ¯Ø§Øª</h1>
        <div class="entity-bar" id="entityDeptHeader"></div>
        <p>Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ØµÙ†Ø§Ù ÙˆØ§Ù„Ù…ÙˆØ±Ø¯ÙŠÙ†</p>
    </header>

    <!-- Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØµÙØ­Ø© -->
    <main class="container">
        <!-- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù…Ø®ØªØµØ±Ø© -->
        <div class="stats-summary" role="region" aria-label="Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø³Ø±ÙŠØ¹Ø©">
            <div>Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù†Ø§ØµØ±: <strong id="countItems">0</strong></div>
            <div id="supplierTotal1Container">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙˆØ±Ø¯ Ø§Ù„Ø£ÙˆÙ„: <strong id="supplierTotal1">0.00</strong> Ø¬.Ù…</div>
            <div id="supplierTotal2Container">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙˆØ±Ø¯ Ø§Ù„Ø«Ø§Ù†ÙŠ: <strong id="supplierTotal2">0.00</strong> Ø¬.Ù…</div>
            <div id="supplierTotal3Container">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙˆØ±Ø¯ Ø§Ù„Ø«Ø§Ù„Ø«: <strong id="supplierTotal3">0.00</strong> Ø¬.Ù…</div>
        </div>

        <section class="stats-grid">
            <div class="stat-card">
                <h3>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£ØµÙ†Ø§Ù</h3>
                <div id="totalItemsStat" class="stat-value">0</div>
            </div>
            <div class="stat-card">
                <h3>Ø§Ù„ØµÙÙˆÙ Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©</h3>
                <div id="completedRowsStat" class="stat-value">0</div>
            </div>
            <div class="stat-card">
                <h3>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù‚ÙŠÙ…Ø©</h3>
                <div id="totalValueStat" class="stat-value">0.00 Ø¬.Ù…</div>
            </div>
        </section>

        <!-- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¬Ù‡Ø© -->
        <section class="entity-config-section">
            <h2 class="section-title"><span>ğŸ¥</span> Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¬Ù‡Ø©</h2>
            <div class="input-grid">
                <div class="enhanced-input">
                    <label for="entityName">Ø§Ø³Ù… Ø§Ù„Ø¬Ù‡Ø©:</label>
                    <input type="text" id="entityName" tabindex="0" aria-label="Ø§Ø³Ù… Ø§Ù„Ø¬Ù‡Ø©" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¬Ù‡Ø©">
                </div>
                <div class="enhanced-input">
                    <label for="entityDepartment">Ø§Ù„Ù‚Ø³Ù…:</label>
                    <input type="text" id="entityDepartment" tabindex="0" aria-label="Ø§Ù„Ù‚Ø³Ù…" placeholder="Ø§Ø³Ù… Ø§Ù„Ù‚Ø³Ù…">
                </div>
            </div>
        </section>

        <!-- Ø¨ÙŠØ§Ù†Ø§Øª Ø£Ø³Ø§Ø³ÙŠØ© -->
        <section class="form-section">
            <h2 class="section-title">ğŸ“‹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</h2>
            <div class="input-grid">
                <div class="enhanced-input">
                    <label for="date">ğŸ“… Ø§Ù„ØªØ§Ø±ÙŠØ®:</label>
                    <input type="date" id="date" required>
                </div>
                <div class="enhanced-input">
                    <label for="supplier1">Ø§Ù„Ù…ÙˆØ±Ø¯ Ø§Ù„Ø£ÙˆÙ„:</label>
                    <input list="suppliersList" id="supplier1" tabindex="0" placeholder="Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ±Ø¯ Ø§Ù„Ø£ÙˆÙ„">
                </div>
                <div class="enhanced-input">
                    <label for="supplier2">Ø§Ù„Ù…ÙˆØ±Ø¯ Ø§Ù„Ø«Ø§Ù†ÙŠ:</label>
                    <input list="suppliersList" id="supplier2" tabindex="0" placeholder="Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ±Ø¯ Ø§Ù„Ø«Ø§Ù†ÙŠ">
                </div>
                <div class="enhanced-input">
                    <label for="supplier3">Ø§Ù„Ù…ÙˆØ±Ø¯ Ø§Ù„Ø«Ø§Ù„Ø«:</label>
                    <input list="suppliersList" id="supplier3" tabindex="0" placeholder="Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ±Ø¯ Ø§Ù„Ø«Ø§Ù„Ø«">
                </div>
                <div class="enhanced-input">
                    <label for="committeeDate">ØªØ§Ø±ÙŠØ® Ø§Ù„Ù„Ø¬Ù†Ø©:</label>
                    <input type="date" id="committeeDate" required>
                </div>
                <div class="enhanced-input">
                    <label for="taxRate">Ù†Ø³Ø¨Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© %:</label>
                    <input type="number" id="taxRate" value="14" min="0" max="100" step="0.01">
                </div>
            </div>
        </section>

        <!-- Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø£ØµÙ†Ø§Ù -->
        <section class="table-container">
            <div class="table-header">
                <span>ğŸ“Š Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø£ØµÙ†Ø§Ù ÙˆØ§Ù„Ø£Ø³Ø¹Ø§Ø± (Ø¶Ø±ÙŠØ¨Ø© Ù…Ù†ÙØµÙ„Ø© Ù„ÙƒÙ„ Ù…ÙˆØ±Ø¯)</span>
                <div class="action-buttons">
                    <button class="btn" onclick="AppManager.addRow()" tabindex="0"><span>â•</span> Ø¥Ø¶Ø§ÙØ© ØµÙ</button>
                </div>
            </div>
            <div class="table-wrapper">
                <table class="enhanced-table" id="itemsTable" aria-label="Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø£ØµÙ†Ø§Ù">
                    <thead>
                        <tr>
                            <th>Ù…</th>
                            <th>Ø§Ø³Ù… Ø§Ù„ØµÙ†Ù</th>
                            <th>Ø§Ù„ÙˆØ­Ø¯Ø©</th>
                            <th>Ø§Ù„ÙƒÙ…ÙŠØ©</th>
                            <th id="th-supplier1">Ø³Ø¹Ø± Ø§Ù„Ù…ÙˆØ±Ø¯ 1</th>
                            <th>Ø¶Ø±ÙŠØ¨Ø© 1</th>
                            <th>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ 1</th>
                            <th id="th-supplier2">Ø³Ø¹Ø± Ø§Ù„Ù…ÙˆØ±Ø¯ 2</th>
                            <th>Ø¶Ø±ÙŠØ¨Ø© 2</th>
                            <th>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ 2</th>
                            <th id="th-supplier3">Ø³Ø¹Ø± Ø§Ù„Ù…ÙˆØ±Ø¯ 3</th>
                            <th>Ø¶Ø±ÙŠØ¨Ø© 3</th>
                            <th>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ 3</th>
                            <th>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th>
                            <th>Ø¥Ø¬Ø±Ø§Ø¡</th>
                        </tr>
                    </thead>
                    <tbody id="itemsTableBody"></tbody>
                    <tfoot>
                        <tr>
                            <td colspan="4"><b>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù‚Ø¨Ù„ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©</b></td>
                            <td id="subtotal1">0.00</td>
                            <td>â€”</td>
                            <td>â€”</td>
                            <td id="subtotal2">0.00</td>
                            <td>â€”</td>
                            <td>â€”</td>
                            <td id="subtotal3">0.00</td>
                            <td>â€”</td>
                            <td>â€”</td>
                            <td colspan="2"></td>
                        </tr>
                        <tr>
                            <td colspan="4"><b>Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ©</b></td>
                            <td>â€”</td>
                            <td id="tax1">0.00</td>
                            <td>â€”</td>
                            <td>â€”</td>
                            <td id="tax2">0.00</td>
                            <td>â€”</td>
                            <td>â€”</td>
                            <td id="tax3">0.00</td>
                            <td>â€”</td>
                            <td colspan="2"></td>
                        </tr>
                        <tr>
                            <td colspan="4">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ (Ø¨Ø¹Ø¯ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©)</td>
                            <td>â€”</td>
                            <td>â€”</td>
                            <td id="finalTotal1">0.00</td>
                            <td>â€”</td>
                            <td>â€”</td>
                            <td id="finalTotal2">0.00</td>
                            <td>â€”</td>
                            <td>â€”</td>
                            <td id="finalTotal3">0.00</td>
                            <td colspan="2"></td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </section>

        <!-- Ø§Ù„ØªÙˆÙ‚ÙŠØ¹Ø§Øª -->
        <section class="signatures-section">
            <h2 class="section-title">âœï¸ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹Ø§Øª ÙˆØ§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯Ø§Øª</h2>
            <div id="signaturesList" class="signatures-grid"></div>
        </section>

        <!-- Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ­ÙƒÙ… -->
        <section class="controls-section">
            <h2 class="section-title">ğŸ› ï¸ Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ­ÙƒÙ…</h2>
            <div class="action-buttons">
                <button class="btn" onclick="AppManager.addRow()" title="Ø¥Ø¶Ø§ÙØ© ØµÙ" tabindex="0">â• Ø¥Ø¶Ø§ÙØ© ØµÙ</button>
                <button class="btn" onclick="AppManager.saveData()" title="Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª" tabindex="0">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
                <button class="btn" onclick="AppManager.loadData()" title="ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª" tabindex="0">ğŸ“ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
                <input type="file" id="jsonFileInput" accept=".json" style="display:none">
                <button class="btn" onclick="AppManager.saveAndGo()" title="Ø­ÙØ¸ ÙˆØ§Ù†ØªÙ‚Ø§Ù„" tabindex="0">ğŸ’¾ Ø­ÙØ¸ ÙˆØ§Ù†ØªÙ‚Ø§Ù„</button>
                <button class="btn" onclick="AppManager.clearTable()" title="Ù…Ø³Ø­ Ø§Ù„Ø¬Ø¯ÙˆÙ„" tabindex="0">ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„</button>
                <button class="btn" onclick="window.print()" title="Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØµÙØ­Ø©" tabindex="0">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©</button>
            </div>
        </section>

        <footer id="signaturesFooter" class="entity-footer" style="text-align:center; margin: 20px 0;"></footer>
    </main>

    <!-- Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© -->
    <datalist id="suppliersList"></datalist>
    <datalist id="itemsList"></datalist>
    <datalist id="staffList"></datalist>

    <script>
        // Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø­Ø³Ù‘Ù†Ø© ÙˆØ§Ù„Ù…Ù‡Ù†ÙŠØ©
        const AppManager = {
            elements: {},
            
            init() {
                this.cacheElements();
                this.addEventListeners();
                this.loadInitialData();
                this.setDefaultDate();
                
                if (this.elements.tableBody.rows.length === 0) {
                    for (let i = 0; i < 3; i++) {
                        this.addRow(false);
                    }
                }
                
                this.updateAllCalculations();
            },

            cacheElements() {
                this.elements = {
                    tableBody: document.getElementById('itemsTableBody'),
                    taxRateInput: document.getElementById('taxRate'),
                    entityName: document.getElementById('entityName'),
                    entityDepartment: document.getElementById('entityDepartment'),
                    entityNameHeader: document.getElementById('entityNameHeader'),
                    entityDeptHeader: document.getElementById('entityDeptHeader'),
                    signaturesList: document.getElementById('signaturesList'),
                    signaturesFooter: document.getElementById('signaturesFooter'),
                    countItems: document.getElementById('countItems'),
                    totalItemsStat: document.getElementById('totalItemsStat'),
                    completedRowsStat: document.getElementById('completedRowsStat'),
                    totalValueStat: document.getElementById('totalValueStat'),
                    supplierTotals: [
                        document.getElementById('supplierTotal1'),
                        document.getElementById('supplierTotal2'),
                        document.getElementById('supplierTotal3')
                    ],
                    supplierTotalContainers: [
                        document.getElementById('supplierTotal1Container'),
                        document.getElementById('supplierTotal2Container'),
                        document.getElementById('supplierTotal3Container')
                    ],
                    subtotals: [
                        document.getElementById('subtotal1'),
                        document.getElementById('subtotal2'),
                        document.getElementById('subtotal3')
                    ],
                    taxes: [
                        document.getElementById('tax1'),
                        document.getElementById('tax2'),
                        document.getElementById('tax3')
                    ],
                    finalTotals: [
                        document.getElementById('finalTotal1'),
                        document.getElementById('finalTotal2'),
                        document.getElementById('finalTotal3')
                    ]
                };
            },

            addEventListeners() {
                document.addEventListener('input', (e) => {
                    const targetId = e.target.id;
                    
                    if (e.target.closest('#itemsTable') || targetId === 'taxRate') {
                        this.updateAllCalculations();
                    }
                    
                    if (targetId === 'entityName' || targetId === 'entityDepartment') {
                        this.saveEntityData();
                    }
                    
                    if (['supplier1', 'supplier2', 'supplier3'].includes(targetId)) {
                        this.updateSupplierHeaders();
                    }
                });

                document.addEventListener('keydown', (e) => {
                    if (e.ctrlKey && e.key === 's') {
                        e.preventDefault();
                        this.saveData();
                    }
                    if (e.ctrlKey && e.key === 'n') {
                        e.preventDefault();
                        this.addRow();
                    }
                });
            },

            setDefaultDate() {
                const dateInput = document.getElementById('date');
                const committeeDateInput = document.getElementById('committeeDate');
                const today = new Date().toISOString().split('T')[0];
                
                if (!dateInput.value) {
                    dateInput.value = today;
                }
                if (!committeeDateInput.value) {
                    committeeDateInput.value = today;
                }
            },

            loadInitialData() {
                const entityName = localStorage.getItem('hospitalName') || '';
                const entityDept = localStorage.getItem('departmentName') || '';
                
                this.elements.entityName.value = entityName;
                this.elements.entityDepartment.value = entityDept;
                this.elements.entityNameHeader.textContent = entityName || 'Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª';
                this.elements.entityDeptHeader.textContent = entityDept;
                
                try {
                    const sigs = JSON.parse(localStorage.getItem('signaturesArray')) || [];
                    if (sigs.length > 0) {
                        this.elements.signaturesList.innerHTML = sigs.map(sig =>
                            `<div class="signature-card">${this.escapeHtml(sig.name)}<br><small>${this.escapeHtml(sig.desc)}</small></div>`
                        ).join("");
                        
                        this.elements.signaturesFooter.innerHTML = sigs.map(sig =>
                            `<b>${this.escapeHtml(sig.name)}</b> Ù€ <span>${this.escapeHtml(sig.desc)}</span>`
                        ).join("ØŒ ");
                    }
                } catch (e) {
                    console.error("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹Ø§Øª:", e);
                }
            },

            saveEntityData() {
                const entityName = this.elements.entityName.value.trim();
                const entityDept = this.elements.entityDepartment.value.trim();
                
                localStorage.setItem('hospitalName', entityName);
                localStorage.setItem('departmentName', entityDept);
                
                this.elements.entityNameHeader.textContent = entityName || 'Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª';
                this.elements.entityDeptHeader.textContent = entityDept;
            },

            updateSupplierHeaders() {
                for (let i = 1; i <= 3; i++) {
                    const supplierName = document.getElementById(`supplier${i}`).value.trim();
                    const th = document.getElementById(`th-supplier${i}`);
                    
                    if (th) {
                        th.textContent = supplierName ? `Ø³Ø¹Ø± (${supplierName})` : `Ø³Ø¹Ø± Ø§Ù„Ù…ÙˆØ±Ø¯ ${i}`;
                    }
                }
            },

            createRowHtml(rowNumber) {
                return `<tr>
                    <td>${rowNumber}</td>
                    <td><input placeholder="Ø§Ø³Ù… Ø§Ù„ØµÙ†Ù" tabindex="0" aria-label="Ø§Ø³Ù… Ø§Ù„ØµÙ†Ù"></td>
                    <td><input placeholder="Ø§Ù„ÙˆØ­Ø¯Ø©" tabindex="0" aria-label="Ø§Ù„ÙˆØ­Ø¯Ø©"></td>
                    <td><input type="number" min="0" step="any" placeholder="Ø§Ù„ÙƒÙ…ÙŠØ©" tabindex="0" aria-label="Ø§Ù„ÙƒÙ…ÙŠØ©"></td>
                    <td><input type="number" min="0" step="any" placeholder="Ø§Ù„Ø³Ø¹Ø±" tabindex="0" aria-label="Ø³Ø¹Ø± Ø§Ù„Ù…ÙˆØ±Ø¯ 1"></td>
                    <td><input type="number"  tabindex="-1" style="background:#f7fafb;" aria-label="Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù…ÙˆØ±Ø¯ 1"></td>
                    <td><input type="number"  tabindex="-1" style="background:#f7fafb;font-weight:bold;" aria-label="Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙˆØ±Ø¯ 1"></td>
                    <td><input type="number" min="0" step="any" placeholder="Ø§Ù„Ø³Ø¹Ø±" tabindex="0" aria-label="Ø³Ø¹Ø± Ø§Ù„Ù…ÙˆØ±Ø¯ 2"></td>
                    <td><input type="number"  tabindex="-1" style="background:#f7fafb;" aria-label="Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù…ÙˆØ±Ø¯ 2"></td>
                    <td><input type="number"  tabindex="-1" style="background:#f7fafb;font-weight:bold;" aria-label="Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙˆØ±Ø¯ 2"></td>
                    <td><input type="number" min="0" step="any" placeholder="Ø§Ù„Ø³Ø¹Ø±" tabindex="0" aria-label="Ø³Ø¹Ø± Ø§Ù„Ù…ÙˆØ±Ø¯ 3"></td>
                    <td><input type="number"  tabindex="-1" style="background:#f7fafb;" aria-label="Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù…ÙˆØ±Ø¯ 3"></td>
                    <td><input type="number"  tabindex="-1" style="background:#f7fafb;font-weight:bold;" aria-label="Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙˆØ±Ø¯ 3"></td>
                    <td><input placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§Øª" tabindex="0" aria-label="Ù…Ù„Ø§Ø­Ø¸Ø§Øª"></td>
                    <td><button class="btn btn-delete" onclick="AppManager.deleteRow(this)" title="Ù…Ø³Ø­ Ø§Ù„ØµÙ" aria-label="Ù…Ø³Ø­ Ø§Ù„ØµÙ">Ù…Ø³Ø­</button></td>
                </tr>`;
            },

            addRow(update = true) {
                const rowCount = this.elements.tableBody.rows.length + 1;
                this.elements.tableBody.insertAdjacentHTML('beforeend', this.createRowHtml(rowCount));
                
                if (update) {
                    this.updateAllCalculations();
                }
            },

            deleteRow(button) {
                if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„ØµÙØŸ')) {
                    button.closest('tr').remove();
                    this.updateAllCalculations();
                }
            },

            clearTable() {
                if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£ØµÙ†Ø§Ù ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„ØŸ')) {
                    this.elements.tableBody.innerHTML = '';
                    this.updateAllCalculations();
                }
            },

            updateAllCalculations() {
                const rows = this.elements.tableBody.rows;
                const taxRate = parseFloat(this.elements.taxRateInput.value) / 100 || 0;
                
                let subtotals = [0, 0, 0];
                let taxes = [0, 0, 0];
                let finals = [0, 0, 0];
                let completedRows = 0;

                for (let i = 0; i < rows.length; i++) {
                    rows[i].cells[0].textContent = i + 1;
                    const inputs = rows[i].querySelectorAll('input');
                    
                    const qty = parseFloat(inputs[2].value) || 0;
                    let rowComplete = qty > 0;

                    for (let j = 0; j < 3; j++) {
                        const priceIdx = 3 + j * 3;
                        const price = parseFloat(inputs[priceIdx].value) || 0;
                        
                        const subtotal = qty * price;
                        const taxVal = subtotal * taxRate;
                        const total = subtotal + taxVal;
                        
                        inputs[priceIdx + 1].value = taxVal > 0 ? taxVal.toFixed(2) : '';
                        inputs[priceIdx + 2].value = total > 0 ? total.toFixed(2) : '';
                        
                        if (price <= 0) {
                            rowComplete = false;
                        }
                        
                        subtotals[j] += subtotal;
                        taxes[j] += taxVal;
                        finals[j] += total;
                    }
                    
                    if (rowComplete) {
                        completedRows++;
                    }
                }

                for (let i = 0; i < 3; i++) {
                    this.elements.subtotals[i].textContent = subtotals[i].toFixed(2);
                    this.elements.taxes[i].textContent = taxes[i].toFixed(2);
                    this.elements.finalTotals[i].textContent = finals[i].toFixed(2);
                    this.elements.supplierTotals[i].textContent = finals[i].toFixed(2);
                }

                const validTotals = finals.filter(t => t > 0);
                const minTotal = validTotals.length > 0 ? Math.min(...validTotals) : 0;

                for (let i = 0; i < 3; i++) {
                    const isMin = finals[i] > 0 && finals[i] === minTotal;
                    this.elements.finalTotals[i].classList.toggle('highlight-cell', isMin);
                    this.elements.supplierTotalContainers[i].classList.toggle('highlight-cell', isMin);
                }

                this.elements.countItems.textContent = rows.length;
                this.elements.totalItemsStat.textContent = rows.length;
                this.elements.completedRowsStat.textContent = completedRows;
                this.elements.totalValueStat.textContent = `${(minTotal || 0).toFixed(2)} Ø¬.Ù…`;
            },
saveData() {
    try {
        const data = {
            entityName: this.elements.entityName.value,
            entityDepartment: this.elements.entityDepartment.value,
            date: document.getElementById('date').value,
            supplier1: document.getElementById('supplier1').value,
            supplier2: document.getElementById('supplier2').value,
            supplier3: document.getElementById('supplier3').value,
            committeeDate: document.getElementById('committeeDate').value,
            taxRate: this.elements.taxRateInput.value,
            table: Array.from(this.elements.tableBody.rows).map(tr => {
                const inputs = tr.querySelectorAll('input');
                return {
                    name: inputs[0].value,
                    unit: inputs[1].value,
                    qty: inputs[2].value,
                    price1: inputs[3].value,
                    tax1: inputs[4]?.value,
                    total1: inputs[5]?.value,
                    price2: inputs[6]?.value,
                    tax2: inputs[7]?.value,
                    total2: inputs[8]?.value,
                    price3: inputs[9]?.value,
                    tax3: inputs[10]?.value,
                    total3: inputs[11]?.value,
                    notes: inputs[12]?.value
                };
            })
        };
        // ØªØ­Ø¯ÙŠØ¯ Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù Ø¨Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ø³Ù… Ø§Ù„Ù…ÙˆØ±Ø¯
        const dateStr = data.date || new Date().toISOString().slice(0,10); // ÙŠÙØ¶Ù„ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„ØªØ§Ø±ÙŠØ® YYYY-MM-DD
        const supplierName = data.supplier1 ? data.supplier1.replace(/[<>:"/\\|?*]+/g, '-') : "Ø¨Ø¯ÙˆÙ†-Ù…ÙˆØ±Ø¯";
        const fileName = `${dateStr}-${supplierName}.json`;

        // Ø¥Ù†Ø´Ø§Ø¡ ÙˆØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù
        const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = fileName;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);

        if (typeof this.showToast === 'function') this.showToast('ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ…Ù„Ù Ø¨Ù†Ø¬Ø§Ø­');
    } catch (e) {
        console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­ÙØ¸:', e);
        alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ù');
    }
},

loadData() {
    // Ø§ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù
    const fileInput = document.getElementById('jsonFileInput');
    fileInput.onchange = (event) => {
        const input = event.target;
        if (!input.files || !input.files[0]) return;
        const file = input.files[0];
        const reader = new FileReader();
        reader.onload = (e) => {
            try {
                const data = JSON.parse(e.target.result);
                this.applyLoadedData(data);
                if (typeof this.showToast === 'function') this.showToast('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø¨Ù†Ø¬Ø§Ø­');
            } catch (e) {
                alert('ØµÙŠØºØ© Ù…Ù„Ù ØºÙŠØ± ØµØ§Ù„Ø­Ø© Ø£Ùˆ ØªØ§Ù„ÙØ©!');
            }
            input.value = "";
        };
        reader.readAsText(file, "utf-8");
    };
    fileInput.click();
},

applyLoadedData(data) {
    this.elements.entityName.value = data.entityName || '';
    this.elements.entityDepartment.value = data.entityDepartment || '';
    document.getElementById('date').value = data.date || '';
    document.getElementById('supplier1').value = data.supplier1 || '';
    document.getElementById('supplier2').value = data.supplier2 || '';
    document.getElementById('supplier3').value = data.supplier3 || '';
    document.getElementById('committeeDate').value = data.committeeDate || '';
    this.elements.taxRateInput.value = data.taxRate || '14';

    this.elements.tableBody.innerHTML = '';
    if (data.table && data.table.length > 0) {
        data.table.forEach((row, index) => {
            this.addRow(false);
            const tr = this.elements.tableBody.rows[index];
            const inputs = tr.querySelectorAll('input');
            inputs[0].value = row.name || '';
            inputs[1].value = row.unit || '';
            inputs[2].value = row.qty || '';
            inputs[3].value = row.price1 || '';
            if (inputs[4]) inputs[4].value = row.tax1 || '';
            if (inputs[5]) inputs[5].value = row.total1 || '';
            if (inputs[6]) inputs[6].value = row.price2 || '';
            if (inputs[7]) inputs[7].value = row.tax2 || '';
            if (inputs[8]) inputs[8].value = row.total2 || '';
            if (inputs[9]) inputs[9].value = row.price3 || '';
            if (inputs[10]) inputs[10].value = row.tax3 || '';
            if (inputs[11]) inputs[11].value = row.total3 || '';
            if (inputs[12]) inputs[12].value = row.notes || '';
        });
    }
    this.saveEntityData();
    this.updateSupplierHeaders();
    this.updateAllCalculations();
},






            saveAndGo() {
                this.saveData();
            },

            showToast(message) {
                const toast = document.createElement('div');
                toast.className = 'toast';
                toast.textContent = message;
                document.body.appendChild(toast);
                
                setTimeout(() => {
                    toast.remove();
                }, 3000);
            },

            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }
        };

        function handleLogout() {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ØŸ')) {
                window.location.href = 'index.html';
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            window.AppManager = AppManager;
            AppManager.init();
        });
    </script>
</body>
</html>