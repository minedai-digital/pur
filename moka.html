<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø© Ø§Ù„ØªÙ‚Ø¯ÙŠØ±ÙŠØ© Ù„Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø£ØµÙ†Ø§Ù - moka</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600&display=swap" rel="stylesheet">
<style>
  body { 
    font-family: 'Cairo', sans-serif; 
    margin: 0; 
    background: #f0f2f5; 
    color: #333; 
    line-height: 1.6;
  }
  
  /* Navbar Styles */
  .navbar {
    background-color: #007bff;
    color: #fff;
    font-family: 'Cairo', sans-serif;
    position: sticky;
    top: 0;
    z-index: 1000;
    box-shadow: 0 2px 6px rgba(0,0,0,0.15);
  }

  .nav-container {
    max-width: 1200px;
    margin: auto;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 20px;
  }

  .nav-logo {
    font-size: 20px;
    font-weight: bold;
  }

  .nav-links {
    list-style: none;
    display: flex;
    gap: 15px;
    margin: 0;
    padding: 0;
  }

  .nav-links li a {
    color: #fff;
    text-decoration: none;
    font-weight: 600;
    padding: 8px 12px;
    border-radius: 6px;
    transition: background 0.2s;
  }

  .nav-links li a:hover {
    background-color: rgba(255,255,255,0.2);
  }

  .nav-toggle {
    display: none;
    font-size: 24px;
    cursor: pointer;
  }

  .container {
    max-width: 1200px;
    margin: 20px auto;
    background: #fff;
    padding: 40px;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    position: relative;
  }

  /* Header Section */
  .header-section {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 30px;
    border-bottom: 2px solid #007bff;
    padding-bottom: 20px;
  }

  .logo-section {
    width: 120px;
    height: 120px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .logo-circle {
    width: 100px;
    height: 100px;
    border: 4px solid #dc3545;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #fff;
    position: relative;
  }

  .logo-inner {
    width: 70px;
    height: 70px;
    background: #007bff;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: bold;
    font-size: 10px;
    text-align: center;
    line-height: 1.2;
  }

  .eagle-symbol {
    position: absolute;
    top: -10px;
    width: 20px;
    height: 20px;
    background: #28a745;
    clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
  }

  .title-section {
    flex: 1;
    text-align: center;
    margin: 0 20px;
  }

  .main-title {
    font-size: 28px;
    font-weight: bold;
    color: #007bff;
    margin-bottom: 15px;
    text-decoration: underline;
  }

  .hospital-header {
    background: #ffd700;
    padding: 8px 15px;
    border-radius: 5px;
    font-weight: bold;
    font-size: 16px;
    text-align: center;
    margin-bottom: 10px;
    border: 1px solid #ddd;
  }

  .contracts-header {
    background: #9e9e9e;
    color: white;
    padding: 8px 15px;
    border-radius: 5px;
    font-weight: bold;
    font-size: 14px;
    text-align: center;
  }

  /* Document Info Section */
  .document-info {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 15px;
    margin: 20px 0;
    padding: 20px;
    background: #f8f9fa;
    border-radius: 8px;
    border: 1px solid #dee2e6;
  }

  .info-field {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .info-field label {
    font-weight: bold;
    min-width: 100px;
  }

  .info-field input {
    flex: 1;
    padding: 8px;
    border: 1px solid #ced4da;
    border-radius: 4px;
    font-family: 'Cairo', sans-serif;
  }

  /* Controls */
  .controls-section {
    text-align: center;
    margin: 30px 0;
    padding: 20px;
    background: #f8f9fa;
    border-radius: 8px;
    border: 1px solid #e9ecef;
  }

  button {
    padding: 12px 24px;
    border: none;
    border-radius: 6px;
    margin: 5px;
    cursor: pointer;
    font-size: 14px;
    font-weight: bold;
    font-family: 'Cairo', sans-serif;
    transition: all 0.2s;
  }

  button:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.15);
  }

  .btn-primary { background: #007bff; color: #fff; }
  .btn-success { background: #28a745; color: #fff; }
  .btn-warning { background: #ffc107; color: #333; }
  .btn-danger { background: #dc3545; color: #fff; }
  .btn-info { background: #17a2b8; color: #fff; }

  /* Main Table */
  .estimation-table {
    width: 100%;
    border-collapse: collapse;
    margin: 20px 0;
    border: 2px solid #333;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
  }

  .estimation-table th,
  .estimation-table td {
    border: 1px solid #333;
    padding: 10px;
    text-align: center;
    font-size: 14px;
    vertical-align: middle;
  }

  .estimation-table th {
    background: #007bff;
    color: white;
    font-weight: bold;
    font-size: 13px;
  }

  .estimation-table input,
  .estimation-table select {
    width: 100%;
    border: none;
    background: transparent;
    text-align: center;
    padding: 5px;
    font-size: 13px;
    font-family: 'Cairo', sans-serif;
  }

  .estimation-table input:focus,
  .estimation-table select:focus {
    outline: 2px solid #007bff;
    background: rgba(0,123,255,0.05);
  }

  .calculated-cell {
    background: #e8f4fd;
    font-weight: bold;
    color: #007bff;
  }

  .total-row {
    background: #f8f9fa;
    font-weight: bold;
    font-size: 15px;
  }

  .total-row td {
    background: #007bff;
    color: white;
    font-weight: bold;
  }

  .highlight-best {
    background: #d4edda !important;
    border: 2px solid #28a745 !important;
    font-weight: bold;
  }

  /* Summary Section */
  .summary-section {
    margin: 30px 0;
    padding: 25px;
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    border-radius: 10px;
    border: 2px solid #007bff;
  }

  .summary-title {
    text-align: center;
    font-size: 20px;
    font-weight: bold;
    color: #007bff;
    margin-bottom: 20px;
    text-decoration: underline;
  }

  .summary-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
  }

  .summary-card {
    background: white;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    border-left: 4px solid #007bff;
  }

  .summary-card h4 {
    margin: 0 0 15px 0;
    color: #007bff;
    font-size: 16px;
  }

  .summary-item {
    display: flex;
    justify-content: space-between;
    margin: 10px 0;
    padding: 8px 0;
    border-bottom: 1px solid #e9ecef;
  }

  .summary-item:last-child {
    border-bottom: none;
    font-weight: bold;
    font-size: 16px;
    color: #007bff;
  }

  /* Recommendations Section */
  .recommendations-section {
    margin: 30px 0;
    padding: 20px;
    background: #fff3cd;
    border: 2px solid #ffc107;
    border-radius: 8px;
  }

  .recommendations-title {
    font-size: 18px;
    font-weight: bold;
    color: #856404;
    margin-bottom: 15px;
    text-align: center;
  }

  .recommendation-item {
    background: white;
    padding: 15px;
    margin: 10px 0;
    border-radius: 6px;
    border-left: 4px solid #ffc107;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
  }

  /* Approval Section */
  .approval-section {
    margin: 40px 0;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 30px;
  }

  .approval-card {
    text-align: center;
    padding: 25px;
    background: white;
    border: 2px solid #007bff;
    border-radius: 10px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  }

  .approval-title {
    font-weight: bold;
    font-size: 16px;
    margin-bottom: 15px;
    color: #007bff;
  }

  .signature-box {
    width: 200px;
    height: 80px;
    border: 2px solid #007bff;
    margin: 15px auto;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #f8f9fa;
    border-radius: 5px;
  }

  .approval-input {
    width: 100%;
    padding: 10px;
    border: 1px solid #ced4da;
    border-radius: 5px;
    text-align: center;
    font-weight: bold;
    margin: 10px 0;
  }

  /* Print Styles */
  @media print {
    .navbar, .controls-section {
      display: none !important;
    }
    
    body {
      background: white;
      font-size: 11pt;
    }
    
    .container {
      box-shadow: none;
      padding: 15px;
      margin: 0;
      max-width: none;
    }
    
    .estimation-table {
      font-size: 10pt;
    }
    
    .estimation-table th {
      background: #007bff !important;
      color: white !important;
      -webkit-print-color-adjust: exact !important;
      print-color-adjust: exact !important;
    }
    
    .calculated-cell {
      background: #e8f4fd !important;
      -webkit-print-color-adjust: exact !important;
      print-color-adjust: exact !important;
    }
    
    .total-row td {
      background: #007bff !important;
      color: white !important;
      -webkit-print-color-adjust: exact !important;
      print-color-adjust: exact !important;
    }
    
    .highlight-best {
      background: #d4edda !important;
      -webkit-print-color-adjust: exact !important;
      print-color-adjust: exact !important;
    }
    
    .hospital-header {
      background: #ffd700 !important;
      -webkit-print-color-adjust: exact !important;
      print-color-adjust: exact !important;
    }
    
    .contracts-header {
      background: #666 !important;
      color: white !important;
      -webkit-print-color-adjust: exact !important;
      print-color-adjust: exact !important;
    }
    
    .summary-section {
      break-inside: avoid;
    }
  }

  /* Responsive Design */
  @media (max-width: 768px) {
    .nav-links {
      display: none;
      flex-direction: column;
      gap: 10px;
      background-color: #007bff;
      padding: 10px 0;
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
    }
    
    .nav-links.active {
      display: flex;
    }
    
    .nav-toggle {
      display: block;
    }

    .container {
      margin: 10px;
      padding: 20px;
    }

    .header-section {
      flex-direction: column;
      text-align: center;
    }

    .logo-section {
      margin-bottom: 20px;
    }

    .estimation-table {
      font-size: 12px;
      overflow-x: auto;
      display: block;
      white-space: nowrap;
    }

    .estimation-table thead,
    .estimation-table tbody,
    .estimation-table th,
    .estimation-table td,
    .estimation-table tr {
      display: block;
    }

    .estimation-table thead tr {
      position: absolute;
      top: -9999px;
      left: -9999px;
    }

    .estimation-table tr {
      border: 2px solid #333;
      margin-bottom: 10px;
      padding: 10px;
      border-radius: 5px;
      background: #f8f9fa;
    }

    .estimation-table td {
      border: none;
      position: relative;
      padding-right: 50%;
      text-align: right;
    }

    .estimation-table td:before {
      content: attr(data-label) ": ";
      position: absolute;
      right: 6px;
      width: 45%;
      padding-left: 10px;
      white-space: nowrap;
      font-weight: bold;
      color: #007bff;
    }
  }
</style>
</head>

<body>
<!-- Navigation Bar -->
<nav class="navbar">
  <div class="nav-container">
    <div class="nav-logo">ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</div>
    <ul class="nav-links">
      <li><a href="main.html">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a></li>
      <li><a href="taw.html">Ø§Ù„ØªÙˆØ±ÙŠØ¯</a></li>
      <li><a href="taf.html">ØªÙØ±ÙŠØº</a></li>
      <li><a href="mahdr.html">Ù…Ø­Ø¶Ø±</a></li>
      <li><a href="talab.html">Ø·Ù„Ø¨</a></li>
      <li><a href="moka.html" style="background-color: rgba(255,255,255,0.2);">Ù…Ù‚Ø§ÙŠØ³Ù‡</a></li>
      <li><a href="tash.html">ØªØ´ÙƒÙŠÙ„</a></li>
      <li><a href="custom.html">Ø§Ù„Ø¶Ø±Ø§ÙŠØ¨</a></li>
    </ul>
    <div class="nav-toggle" onclick="toggleMenu()">â˜°</div>
  </div>
</nav>

<div class="container">
  <!-- Header Section -->
  <div class="header-section">
    <div class="logo-section">
      <div class="logo-circle">
        <div class="eagle-symbol"></div>
        <div class="logo-inner">
          <div>ÙˆØ²Ø§Ø±Ø©<br>Ø§Ù„ØµØ­Ø©<br>ÙˆØ§Ù„Ø³ÙƒØ§Ù†</div>
        </div>
      </div>
    </div>
    
    <div class="title-section">
      <div class="hospital-header">Ù…Ø³ØªØ´ÙÙ‰ Ø³Ù…Ù†ÙˆØ¯ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ</div>
      <div class="contracts-header">Ø§Ù„ØªØ¹Ø§Ù‚Ø¯Ø§Øª</div>
      <div class="main-title">Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø© Ø§Ù„ØªÙ‚Ø¯ÙŠØ±ÙŠØ© Ù„Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø£ØµÙ†Ø§Ù</div>
    </div>
  </div>

  <!-- Document Info -->
  <div class="document-info">
    <div class="info-field">
      <label>Ø±Ù‚Ù… Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø©:</label>
      <input type="text" id="estimationNumber" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø©">
    </div>
    <div class="info-field">
      <label>Ø§Ù„ØªØ§Ø±ÙŠØ®:</label>
      <input type="date" id="estimationDate">
    </div>
    <div class="info-field">
      <label>Ù†ÙˆØ¹ Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ©:</label>
      <select id="tenderType">
        <option value="">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ©</option>
        <option value="Ø¹Ø§Ù…Ø©">Ù…Ù†Ø§Ù‚ØµØ© Ø¹Ø§Ù…Ø©</option>
        <option value="Ù…Ø­Ø¯ÙˆØ¯Ø©">Ù…Ù†Ø§Ù‚ØµØ© Ù…Ø­Ø¯ÙˆØ¯Ø©</option>
        <option value="Ù…Ø­Ù„ÙŠØ©">Ù…Ù†Ø§Ù‚ØµØ© Ù…Ø­Ù„ÙŠØ©</option>
        <option value="Ø¹Ø§Ø¬Ù„Ø©">Ù…Ù†Ø§Ù‚ØµØ© Ø¹Ø§Ø¬Ù„Ø©</option>
      </select>
    </div>
    <div class="info-field">
      <label>Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ù…Ø®ØªØµØ©:</label>
      <input type="text" id="responsibleDepartment" value="Ù‚Ø³Ù… Ø§Ù„ØªØ¹Ø§Ù‚Ø¯Ø§Øª - Ù…Ø³ØªØ´ÙÙ‰ Ø³Ù…Ù†ÙˆØ¯">
    </div>
  </div>

  <!-- Controls -->
  <div class="controls-section">
    <button class="btn-primary" onclick="loadFromSystem()">ğŸ“‹ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
    <button class="btn-success" onclick="addEstimationRow()">â• Ø¥Ø¶Ø§ÙØ© ØµÙ†Ù</button>
    <button class="btn-info" onclick="calculateEstimation()">ğŸ§® Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø©</button>
    <button class="btn-warning" onclick="generateRecommendations()">ğŸ’¡ ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ØªÙˆØµÙŠØ§Øª</button>
    <button class="btn-success" onclick="saveEstimation()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø©</button>
    <button class="btn-danger" onclick="clearForm()">ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„</button>
    <button class="btn-success" onclick="window.print()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©</button>
  </div>

  <!-- Main Estimation Table -->
  <table class="estimation-table">
    <thead>
      <tr>
        <th>Ù…</th>
        <th>Ø§Ø³Ù… Ø§Ù„ØµÙ†Ù</th>
        <th>Ø§Ù„ÙˆØ­Ø¯Ø©</th>
        <th>Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</th>
        <th>Ø§Ù„Ø³Ø¹Ø± Ø§Ù„ØªÙ‚Ø¯ÙŠØ±ÙŠ (Ø§Ù„ÙˆØ­Ø¯Ø©)</th>
        <th>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„ØªÙ‚Ø¯ÙŠØ±ÙŠ</th>
        <th>Ù…ØªÙˆØ³Ø· Ø§Ù„Ø³ÙˆÙ‚</th>
        <th>Ø£Ù‚Ù„ Ø³Ø¹Ø± Ù…ØªÙˆÙ‚Ø¹</th>
        <th>Ø£Ø¹Ù„Ù‰ Ø³Ø¹Ø± Ù…ØªÙˆÙ‚Ø¹</th>
        <th>Ø¯Ø±Ø¬Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±Ø©</th>
        <th>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th>
      </tr>
    </thead>
    <tbody id="estimationTableBody">
      <tr>
        <td data-label="Ù…">1</td>
        <td data-label="Ø§Ø³Ù… Ø§Ù„ØµÙ†Ù"><input type="text" placeholder="Ø§Ø³Ù… Ø§Ù„ØµÙ†Ù"></td>
        <td data-label="Ø§Ù„ÙˆØ­Ø¯Ø©"><input type="text" placeholder="Ø§Ù„ÙˆØ­Ø¯Ø©"></td>
        <td data-label="Ø§Ù„ÙƒÙ…ÙŠØ©"><input type="number" value="1" min="1" step="1" oninput="calculateRow(this)"></td>
        <td data-label="Ø§Ù„Ø³Ø¹Ø± Ø§Ù„ØªÙ‚Ø¯ÙŠØ±ÙŠ"><input type="number" placeholder="0.00" step="0.01" oninput="calculateRow(this)"></td>
        <td data-label="Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ" class="calculated-cell">0.00</td>
        <td data-label="Ù…ØªÙˆØ³Ø· Ø§Ù„Ø³ÙˆÙ‚"><input type="number" placeholder="0.00" step="0.01" oninput="calculateRow(this)"></td>
        <td data-label="Ø£Ù‚Ù„ Ø³Ø¹Ø±" class="calculated-cell">0.00</td>
        <td data-label="Ø£Ø¹Ù„Ù‰ Ø³Ø¹Ø±" class="calculated-cell">0.00</td>
        <td data-label="Ø¯Ø±Ø¬Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±Ø©"><select onchange="updateRiskColor(this)"><option value="Ù…Ù†Ø®ÙØ¶Ø©">Ù…Ù†Ø®ÙØ¶Ø©</option><option value="Ù…ØªÙˆØ³Ø·Ø©">Ù…ØªÙˆØ³Ø·Ø©</option><option value="Ø¹Ø§Ù„ÙŠØ©">Ø¹Ø§Ù„ÙŠØ©</option></select></td>
        <td data-label="Ù…Ù„Ø§Ø­Ø¸Ø§Øª"><input type="text" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§Øª"></td>
      </tr>
    </tbody>
    <tfoot>
      <tr class="total-row">
        <td colspan="5">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹Ø§Ù…</td>
        <td id="grandTotal">0.00</td>
        <td id="avgMarketTotal">0.00</td>
        <td id="minExpectedTotal">0.00</td>
        <td id="maxExpectedTotal">0.00</td>
        <td colspan="2">Ø¬Ù†ÙŠÙ‡ Ù…ØµØ±ÙŠ</td>
      </tr>
    </tfoot>
  </table>

  <!-- Summary Section -->
  <div class="summary-section">
    <div class="summary-title">Ù…Ù„Ø®Øµ Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø© Ø§Ù„ØªÙ‚Ø¯ÙŠØ±ÙŠØ©</div>
    
    <div class="summary-grid">
      <div class="summary-card">
        <h4>ğŸ“Š Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</h4>
        <div class="summary-item">
          <span>Ø¹Ø¯Ø¯ Ø§Ù„Ø£ØµÙ†Ø§Ù:</span>
          <span id="totalItems">0</span>
        </div>
        <div class="summary-item">
          <span>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙƒÙ…ÙŠØ©:</span>
          <span id="totalQuantity">0</span>
        </div>
        <div class="summary-item">
          <span>Ù…ØªÙˆØ³Ø· Ø§Ù„Ø³Ø¹Ø± Ù„Ù„ÙˆØ­Ø¯Ø©:</span>
          <span id="avgUnitPrice">0.00 Ø¬.Ù…</span>
        </div>
        <div class="summary-item">
          <span>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªÙ‚Ø¯ÙŠØ±:</span>
          <span id="estimationTotal">0.00 Ø¬.Ù…</span>
        </div>
      </div>
      
      <div class="summary-card">
        <h4>ğŸ“ˆ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø®Ø§Ø·Ø±</h4>
        <div class="summary-item">
          <span>Ø£ØµÙ†Ø§Ù Ù…Ù†Ø®ÙØ¶Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±:</span>
          <span id="lowRiskItems">0</span>
        </div>
        <div class="summary-item">
          <span>Ø£ØµÙ†Ø§Ù Ù…ØªÙˆØ³Ø·Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±:</span>
          <span id="mediumRiskItems">0</span>
        </div>
        <div class="summary-item">
          <span>Ø£ØµÙ†Ø§Ù Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ù…Ø®Ø§Ø·Ø±:</span>
          <span id="highRiskItems">0</span>
        </div>
        <div class="summary-item">
          <span>Ø¯Ø±Ø¬Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±Ø© Ø§Ù„Ø¹Ø§Ù…Ø©:</span>
          <span id="overallRisk">-</span>
        </div>
      </div>
      
      <div class="summary-card">
        <h4>ğŸ’° Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø§Ù„ÙŠ</h4>
        <div class="summary-item">
          <span>Ø£Ù‚Ù„ ØªÙƒÙ„ÙØ© Ù…ØªÙˆÙ‚Ø¹Ø©:</span>
          <span id="minTotalCost">0.00 Ø¬.Ù…</span>
        </div>
        <div class="summary-item">
          <span>Ø£Ø¹Ù„Ù‰ ØªÙƒÙ„ÙØ© Ù…ØªÙˆÙ‚Ø¹Ø©:</span>
          <span id="maxTotalCost">0.00 Ø¬.Ù…</span>
        </div>
        <div class="summary-item">
          <span>Ù†Ø³Ø¨Ø© Ø§Ù„ØªÙˆÙÙŠØ± Ø§Ù„Ù…Ø­ØªÙ…Ù„Ø©:</span>
          <span id="savingsPercentage">0%</span>
        </div>
        <div class="summary-item">
          <span>Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø©:</span>
          <span id="recommendedBudget">0.00 Ø¬.Ù…</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Recommendations Section -->
  <div class="recommendations-section" id="recommendationsSection" style="display: none;">
    <div class="recommendations-title">ğŸ¯ Ø§Ù„ØªÙˆØµÙŠØ§Øª ÙˆØ§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª</div>
    <div id="recommendationsList"></div>
  </div>

  <!-- Approval Section -->
  <div class="approval-section">
    <div class="approval-card">
      <div class="approval-title">Ø¥Ø¹Ø¯Ø§Ø¯</div>
      <input type="text" class="approval-input" id="preparedBy" placeholder="Ø§Ø³Ù… Ù…Ø¹Ø¯ Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø©">
      <div class="signature-box">Ø§Ù„ØªÙˆÙ‚ÙŠØ¹</div>
      <input type="date" class="approval-input" id="preparedDate">
    </div>
    
    <div class="approval-card">
      <div class="approval-title">Ù…Ø±Ø§Ø¬Ø¹Ø©</div>
      <input type="text" class="approval-input" id="reviewedBy" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹">
      <div class="signature-box">Ø§Ù„ØªÙˆÙ‚ÙŠØ¹</div>
      <input type="date" class="approval-input" id="reviewedDate">
    </div>
    
    <div class="approval-card">
      <div class="approval-title">Ø§Ø¹ØªÙ…Ø§Ø¯</div>
      <input type="text" class="approval-input" id="approvedBy" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø¹ØªÙ…Ø¯">
      <div class="signature-box">Ø§Ù„ØªÙˆÙ‚ÙŠØ¹</div>
      <input type="date" class="approval-input" id="approvedDate">
    </div>
  </div>
</div>

<script>
let rowCount = 0;

// ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ÙÙŠ Ø§Ù„Ù‡Ø§ØªÙ
function toggleMenu() {
  document.querySelector('.nav-links').classList.toggle('active');
}

// ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµÙØ­Ø©
document.addEventListener('DOMContentLoaded', function() {
  const today = new Date().toISOString().split('T')[0];
  document.getElementById('estimationDate').value = today;
  document.getElementById('preparedDate').value = today;
  
  // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
  loadSavedData();
  
  // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø© Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
  calculateEstimation();
});

// Ø¥Ø¶Ø§ÙØ© ØµÙ Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ù…Ù‚Ø§ÙŠØ³Ø©
function addEstimationRow() {
  rowCount = document.querySelectorAll('#estimationTableBody tr').length + 1;
  const tbody = document.getElementById('estimationTableBody');
  const newRow = document.createElement('tr');
  
  newRow.innerHTML = `
    <td data-label="Ù…">${rowCount}</td>
    <td data-label="Ø§Ø³Ù… Ø§Ù„ØµÙ†Ù"><input type="text" placeholder="Ø§Ø³Ù… Ø§Ù„ØµÙ†Ù"></td>
    <td data-label="Ø§Ù„ÙˆØ­Ø¯Ø©"><input type="text" placeholder="Ø§Ù„ÙˆØ­Ø¯Ø©"></td>
    <td data-label="Ø§Ù„ÙƒÙ…ÙŠØ©"><input type="number" value="1" min="1" step="1" oninput="calculateRow(this)"></td>
    <td data-label="Ø§Ù„Ø³Ø¹Ø± Ø§Ù„ØªÙ‚Ø¯ÙŠØ±ÙŠ"><input type="number" placeholder="0.00" step="0.01" oninput="calculateRow(this)"></td>
    <td data-label="Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ" class="calculated-cell">0.00</td>
    <td data-label="Ù…ØªÙˆØ³Ø· Ø§Ù„Ø³ÙˆÙ‚"><input type="number" placeholder="0.00" step="0.01" oninput="calculateRow(this)"></td>
    <td data-label="Ø£Ù‚Ù„ Ø³Ø¹Ø±" class="calculated-cell">0.00</td>
    <td data-label="Ø£Ø¹Ù„Ù‰ Ø³Ø¹Ø±" class="calculated-cell">0.00</td>
    <td data-label="Ø¯Ø±Ø¬Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±Ø©">
      <select onchange="updateRiskColor(this)">
        <option value="Ù…Ù†Ø®ÙØ¶Ø©">Ù…Ù†Ø®ÙØ¶Ø©</option>
        <option value="Ù…ØªÙˆØ³Ø·Ø©">Ù…ØªÙˆØ³Ø·Ø©</option>
        <option value="Ø¹Ø§Ù„ÙŠØ©">Ø¹Ø§Ù„ÙŠØ©</option>
            </select>
    </td>
    <td data-label="Ù…Ù„Ø§Ø­Ø¸Ø§Øª"><input type="text" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§Øª"></td>
  `;
  tbody.appendChild(newRow);
  calculateEstimation();
}

// Ø­Ø³Ø§Ø¨ ØµÙ ÙˆØ§Ø­Ø¯
function calculateRow(input) {
  const row = input.closest('tr');
  const qty = parseFloat(row.querySelector('td[data-label="Ø§Ù„ÙƒÙ…ÙŠØ©"] input').value) || 0;
  const price = parseFloat(row.querySelector('td[data-label="Ø§Ù„Ø³Ø¹Ø± Ø§Ù„ØªÙ‚Ø¯ÙŠØ±ÙŠ"] input').value) || 0;
  const marketAvg = parseFloat(row.querySelector('td[data-label="Ù…ØªÙˆØ³Ø· Ø§Ù„Ø³ÙˆÙ‚"] input').value) || 0;

  const total = qty * price;
  row.querySelector('td[data-label="Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ"]').textContent = total.toFixed(2);

  // Ø­Ø³Ø§Ø¨ Ø£Ù‚Ù„ ÙˆØ£Ø¹Ù„Ù‰ Ø³Ø¹Ø± Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø³ÙˆÙ‚ Â±10%
  row.querySelector('td[data-label="Ø£Ù‚Ù„ Ø³Ø¹Ø±"]').textContent = (marketAvg * 0.9).toFixed(2);
  row.querySelector('td[data-label="Ø£Ø¹Ù„Ù‰ Ø³Ø¹Ø±"]').textContent = (marketAvg * 1.1).toFixed(2);

  calculateEstimation();
}

// Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„
function calculateEstimation() {
  let totalQty = 0, totalPrice = 0, totalMarket = 0, totalMin = 0, totalMax = 0;
  let low = 0, medium = 0, high = 0;
  const rows = document.querySelectorAll('#estimationTableBody tr');

  rows.forEach(row => {
    const qty = parseFloat(row.querySelector('td[data-label="Ø§Ù„ÙƒÙ…ÙŠØ©"] input').value) || 0;
    const total = parseFloat(row.querySelector('td[data-label="Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ"]').textContent) || 0;
    const marketAvg = parseFloat(row.querySelector('td[data-label="Ù…ØªÙˆØ³Ø· Ø§Ù„Ø³ÙˆÙ‚"] input').value) || 0;
    const minVal = parseFloat(row.querySelector('td[data-label="Ø£Ù‚Ù„ Ø³Ø¹Ø±"]').textContent) || 0;
    const maxVal = parseFloat(row.querySelector('td[data-label="Ø£Ø¹Ù„Ù‰ Ø³Ø¹Ø±"]').textContent) || 0;
    const risk = row.querySelector('td[data-label="Ø¯Ø±Ø¬Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±Ø©"] select').value;

    totalQty += qty;
    totalPrice += total;
    totalMarket += marketAvg;
    totalMin += minVal;
    totalMax += maxVal;

    if (risk === "Ù…Ù†Ø®ÙØ¶Ø©") low++;
    else if (risk === "Ù…ØªÙˆØ³Ø·Ø©") medium++;
    else if (risk === "Ø¹Ø§Ù„ÙŠØ©") high++;
  });

  // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¬Ø§Ù…ÙŠØ¹ Ø¨Ø§Ù„Ø¬Ø¯ÙˆÙ„
  document.getElementById("grandTotal").textContent = totalPrice.toFixed(2);
  document.getElementById("avgMarketTotal").textContent = totalMarket.toFixed(2);
  document.getElementById("minExpectedTotal").textContent = totalMin.toFixed(2);
  document.getElementById("maxExpectedTotal").textContent = totalMax.toFixed(2);

  // Ù…Ù„Ø®Øµ
  document.getElementById("totalItems").textContent = rows.length;
  document.getElementById("totalQuantity").textContent = totalQty;
  document.getElementById("avgUnitPrice").textContent = (totalPrice / (totalQty || 1)).toFixed(2) + " Ø¬.Ù…";
  document.getElementById("estimationTotal").textContent = totalPrice.toFixed(2) + " Ø¬.Ù…";

  document.getElementById("lowRiskItems").textContent = low;
  document.getElementById("mediumRiskItems").textContent = medium;
  document.getElementById("highRiskItems").textContent = high;

  let overallRisk = "-";
  if (high > 0) overallRisk = "Ø¹Ø§Ù„ÙŠØ©";
  else if (medium > 0) overallRisk = "Ù…ØªÙˆØ³Ø·Ø©";
  else overallRisk = "Ù…Ù†Ø®ÙØ¶Ø©";
  document.getElementById("overallRisk").textContent = overallRisk;

  document.getElementById("minTotalCost").textContent = totalMin.toFixed(2) + " Ø¬.Ù…";
  document.getElementById("maxTotalCost").textContent = totalMax.toFixed(2) + " Ø¬.Ù…";
  const saving = ((totalMax - totalMin) / (totalMax || 1)) * 100;
  document.getElementById("savingsPercentage").textContent = saving.toFixed(1) + "%";
  document.getElementById("recommendedBudget").textContent = ((totalPrice + totalMarket) / 2).toFixed(2) + " Ø¬.Ù…";

  saveData();
}

// ØªØ­Ø¯ÙŠØ« Ø£Ù„ÙˆØ§Ù† Ø­Ø³Ø¨ Ø§Ù„Ù…Ø®Ø§Ø·Ø±Ø©
function updateRiskColor(select) {
  const cell = select.closest('td');
  cell.style.background = "";
  if (select.value === "Ù…Ù†Ø®ÙØ¶Ø©") cell.style.background = "#d4edda";
  if (select.value === "Ù…ØªÙˆØ³Ø·Ø©") cell.style.background = "#fff3cd";
  if (select.value === "Ø¹Ø§Ù„ÙŠØ©") cell.style.background = "#f8d7da";
  calculateEstimation();
}

// ØªÙˆÙ„ÙŠØ¯ ØªÙˆØµÙŠØ§Øª
function generateRecommendations() {
  const total = parseFloat(document.getElementById("grandTotal").textContent) || 0;
  const overallRisk = document.getElementById("overallRisk").textContent;

  const recSection = document.getElementById("recommendationsSection");
  const recList = document.getElementById("recommendationsList");
  recList.innerHTML = "";

  if (total > 100000) recList.innerHTML += `<div class="recommendation-item">ğŸ’¡ ÙŠÙØ¶Ù„ ØªÙ‚Ø³ÙŠÙ… Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ© Ø¥Ù„Ù‰ Ù…Ø±Ø§Ø­Ù„ Ù„ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…Ø®Ø§Ø·Ø±.</div>`;
  if (overallRisk === "Ø¹Ø§Ù„ÙŠØ©") recList.innerHTML += `<div class="recommendation-item">âš ï¸ ÙŠØ¬Ø¨ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø£ØµÙ†Ø§Ù Ø°Ø§Øª Ø§Ù„Ù…Ø®Ø§Ø·Ø± Ø§Ù„Ø¹Ø§Ù„ÙŠØ© Ø¨Ø¹Ù†Ø§ÙŠØ© Ù‚Ø¨Ù„ Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯.</div>`;
  if (total < 5000) recList.innerHTML += `<div class="recommendation-item">âœ… ÙŠÙ…ÙƒÙ† Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø´Ø±Ø§Ø¡ Ù…Ø¨Ø§Ø´Ø±Ø© Ù„Ø¹Ø¯Ù… ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„Ù…Ø§Ù„ÙŠ.</div>`;

  recSection.style.display = "block";
}

// Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„
function clearForm() {
  localStorage.removeItem("estimationData");
  document.getElementById("estimationTableBody").innerHTML = "";
  addEstimationRow();
  calculateEstimation();
}

// Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
function saveData() {
  const data = document.querySelector('.container').innerHTML;
  localStorage.setItem("estimationData", data);
}

// ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
function loadSavedData() {
  const saved = localStorage.getItem("estimationData");
  if (saved) {
    document.querySelector('.container').innerHTML = saved;
  }
}

// Ø²Ø± ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª (placeholder)
function loadFromSystem() {
  alert("ğŸ“‹ Ø³ÙŠØªÙ… Ø±Ø¨Ø· ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ù†Ø¸Ø§Ù… Ù„Ø§Ø­Ù‚Ù‹Ø§.");
}

function saveEstimation() {
  alert("ğŸ’¾ ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø© Ø¨Ù†Ø¬Ø§Ø­!");
}
</script>
</body>
</html>
